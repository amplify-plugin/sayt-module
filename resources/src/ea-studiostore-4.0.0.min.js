/*
 Copyright (c) 2011-2018 EasyAsk Technologies, Inc. All Rights Reserved.
 Use, reproduction, transfer, publication or disclosure is prohibited
 except in accordance with the License Agreement.
*/
(function(d){"function"===typeof define&&define.amd?define("ea-store",["jquery","ea-handlebars","ea-search-history","jquery/ui"],d):d(window.$ea||window.eaj$183||jQuery,null,window.EASearchHistory||null)})(function(d,p,n){d.urlParam=function(a,b){var c=RegExp("[?&]"+a+"=([^&#]*)").exec(b||window.location.href);return null==c?null:c[1]};EASearchDemo=function(){};EASearchDemo.prototype={defaults:{navTemplate:"../StudioStore/src/templates/navigation.hbs",prodTemplate:"/EasyAsk/StudioStore/src/templates/products.hbs",
server:"",dct:"EcomDemo",idInput:"question",idButton:"search",cols:4,fields:{id:"Product_Id",image:"picture",name:"Product_Name",price:"Price",desc:"Description",mfr:"Manufacturer"},extraProperties:"",overlayFields:!0,value:function(a,b){return a[b]}},ATTR_VALUE_TYPE_RANGE:2,path:"",currentPageSize:16,currentPage:1,currentSort:"-default-",pageCount:0,loadAndCompile:function(){var a=this,b=d.Deferred();require(["text!"+a.config.navTemplate,"text!"+a.config.prodTemplate],function(c,d){a.compiledNav=
p.compile(c);a.compiledProd=p.compile(d);b.resolve()});return b.promise()},KEYCODE_ENTER:13,KEYCODE_NUMPAD_ENTER:176,init:function(a){var b=this,c=d.extend(!0,this.defaults,a);b.config=c;var e=b.loadAndCompile();this.baseURL=c.server+"/EasyAsk/apps/Advisor.jsp?indexed=1&ie=UTF-8&rootprods=1&disp=json&dct="+c.dct;if(c.extraProperties&&d.isArray(c.extraProperties))for(var f=0;f<c.extraProperties.length;f++){var g=c.extraProperties[f];g.name&&g.value&&(this.baseURL+="&eap_"+g.name+"="+encodeURIComponent(g.value))}this.basePromotionURL=
c.server+"/EasyAsk/apps/CrossSellToResults.jsp?indexed=1&ie=UTF-8&rootprods=1&disp=json&dct="+c.dct;this.value=this.defaults.value;a.sessionid?(this.baseURL+="&sessionid="+a.sessionid,this.basePromotionURL+="&sessionid="+a.sessionid):(this.baseURL+="&oneshot=1",this.basePromotionURL+="&oneshot=1");d("#"+c.idInput).bind("keydown",function(a){return b.KEYCODE_ENTER==a.keyCode||b.KEYCODE_NUMPAD_ENTER==a.keyCode?(window.setTimeout(function(){d("#"+c.idButton).click()},100),a.preventDefault(),!1):!0});
d("#"+c.idButton).unbind("click").click(function(a){var e=d.trim(d("#"+c.idInput).val());e&&b.executeSearch(e);a.preventDefault();return!1});d(".ea-page-first").click(function(){b.pageOp("first")});d(".ea-page-next").click(function(){b.pageOp("next")});d(".ea-page-prev").click(function(){b.pageOp("prev")});d(".ea-page-last").click(function(){b.pageOp("last")});d(".ea-current-page").bind("keydown",function(a){if(b.KEYCODE_ENTER==a.keyCode||b.KEYCODE_NUMPAD_ENTER==a.keyCode)if(a=d(this).val(),!isNaN(a)&&
0<a&&b.pageCount>=a)b.gotoPage(a);else return alert("Enter a number between 1 and "+b.pageCount),!1});d(".ea-select-results-per-page").change(function(a){b.currentPageSize=d(this).val();b.currentPage=1;b.pageOp("first")});d(".ea-select-sort-by").change(function(a){b.currentSort=d(this).val();b.currentPage=1;b.pageOp("first")});d("#tabs").tabs().hide();if(c.menu&&c.menu.length){a="";for(f=0;f<c.menu.length;f++)g=c.menu[f],a+='<li class="ea-toplevel-menu-item"><a class="ea-toplevel-nav" ea-group="'+
g.val+'" href="#">'+g.label+"</a></li>";d(".ea-toplevel-menu-bar").html(a)}else d(".ea-toplevel-menu-area").hide();this.options=c;"onpopstate"in window&&(b=this,window.onpopstate=function(a){a.state?(window.console&&console.log("popstate: "+a.state),b.executeCall(a.state)):0<history.length&&(history.back(),window.console&&console.log("popstate nothing"));return!1});return e},formatNumber:function(a,b,c){c="\\d(?=(\\d{"+(c||3)+"})+"+(0<b?"\\.":"$")+")";return Number(a).toFixed(Math.max(0,~~b)).replace(RegExp(c,
"g"),"$&,")},rawNumber:function(a,b){return Number(a).toFixed(Math.max(0,~~b))},addPath:function(a){return"&CatPath="+encodeURIComponent(this.path+(a?"////"+a:""))},formURL:function(){return this.baseURL+"&ResultsPerPage="+this.currentPageSize+"&defsortcols="+("-default-"==this.currentSort?"":this.currentSort)},executeSearch:function(a,b){this.path=b||"";var c=this.formURL()+"&RequestAction=advisor&RequestData=CA_Search&q="+encodeURIComponent(a)+this.addPath();this.invoke(c)},executeAttribute:function(a,
b,c){a=this.formURL()+"&RequestAction=advisor&RequestData=CA_AttributeSelected&CatPath="+encodeURIComponent(c||this.path)+"&AttribSel="+encodeURIComponent(a+" = '"+b+"'");this.invoke(a)},executeSEORangeAttr:function(a,b,c){a=this.seoPath?this.seoPath.split("/"):[];c=c.substring(0,c.indexOf(":"));for(var d=[],f=0;f<a.length;f++){var g=a[f];0!=g.indexOf(c)&&d.push(g)}d.push(c+":"+b);this.executeBreadcrumbClick(d.join("/"))},executeRangeAttr:function(a,b,c){if(c)this.executeSEORangeAttr(a,b,c);else{c=
this.path.split("////");for(var d="AttribSelect="+a+" = '",f=[],g=0;g<c.length;g++){var h=c[g];0!=h.indexOf(d)&&f.push(h)}this.executeAttribute(a,b,f.join("////"))}},executeMVAttribute:function(a,b){var c=this.formURL()+"&RequestAction=advisor&RequestData=CA_AttributeSelected&CatPath="+encodeURIComponent(b||this.path)+"&AttribSel="+encodeURIComponent(a);this.invoke(c)},executeToplevelArrangeBy:function(a){a=this.formURL()+"&RequestAction=advisor&RequestData=CA_BreadcrumbClick&CatPath=&defarrangeby="+
encodeURIComponent(a);this.invoke(a)},executeBreadcrumbClick:function(a){"All Products"==a&&(a="");a=this.formURL()+"&RequestAction=advisor&RequestData=CA_BreadcrumbClick&CatPath="+encodeURIComponent(a);this.invoke(a)},executeStudioPreview:function(a){a=this.formURL()+"&studiopreview=1&RequestAction=advisor&RequestData=CA_BreadcrumbClick&CatPath="+encodeURIComponent(a);this.invoke(a)},executeStudioPreviewSearch:function(a,b){var c=this.formURL()+"&studiopreview=1&RequestAction=advisor&RequestData=CA_Search&CatPath="+
encodeURIComponent(b)+"&question="+encodeURIComponent(a);this.invoke(c)},gotoPage:function(a){a=this.formURL()+"&RequestAction=navbar&RequestData="+encodeURIComponent("page"+a)+this.addPath();this.invoke(a)},pageOp:function(a){a=this.formURL()+"&RequestAction=navbar&RequestData="+encodeURIComponent(a)+this.addPath()+"&currentpage="+this.currentPage;this.invoke(a)},updatePagination:function(a){this.currentPage=a.currentPage;this.pageCount=a.pageCount;d(".ea-first-item").html(a.firstItem);d(".ea-last-item").html(a.lastItem);
d(".ea-total-items").html(a.totalItems);d(".ea-current-page").val(a.currentPage);d(".ea-total-pages").html(a.pageCount);1==a.pageCount?d(".ea-page-first, .ea-page-prev, .ea-page-next, .ea-page-last, .ea-current-page").attr("disabled","disabled").addClass("ea-disabled"):(d(".ea-current-page").removeAttr("disabled").removeClass("ea-disabled"),1==a.currentPage?d(".ea-page-first, .ea-page-prev").attr("disabled","disabled").addClass("ea-disabled"):d(".ea-page-first, .ea-page-prev").removeAttr("disabled").removeClass("ea-disabled"),
a.pageCount==a.currentPage?d(".ea-page-next, .ea-page-last").attr("disabled","disabled").addClass("ea-disabled"):d(".ea-page-next, .ea-page-last").removeAttr("disabled").removeClass("ea-disabled"));d(".ea-results-controls").show()},getNormalizedValue:function(a){return(Math.round(2*parseFloat(a))/2).toFixed(1)},findItem:function(a){var b=this.options.fields;if(b.id)for(var c=this.currentProducts,d=0;d<c.length;d++)if(c[d][b.id]==a)return c[d];return""},findCarveOut:function(a){var b=this.options.fields;
if(b.id)for(var c=this.currentCarveOuts,d=0;d<c.length;d++)if(c[d][b.id]==a)return c[d];return""},findFeaturedItem:function(a){var b=this.options.fields;if(b.id)for(var c=this.featuredItems,d=0;d<c.length;d++)if(c[d][b.id]==a)return c[d];return""},promotionTypes:"Cross-Sell;Up-Sell;Down-Sell;Add-On;Common Item;Substitution;Complementary;Non-Complementary;Promotions".split(";"),getPromotions:function(a){this.getPromotionByType(a,0,promotionTypes,results)},getItems:function(a){return a&&a.products?
a.products.items:null},processPromotionResults:function(a,b,c){(a=this.getItems(a))&&a.length&&c.push({type:b,items:a})},getPromotionByType:function(a,b,c,e){if(b<c.length){var f=this;d.ajax({url:this.basePromotionURL,data:{q:a,type:c[b]},type:"POST",crossDomain:!0,dataType:"jsonp",success:function(d,h,l){f.processPromotionResults(d,c[b],e);f.getPromotionByType(a,b+1,c,e)},error:function(a,b,c){alert("error: "+a)}})}else this.processPromotions(a,e)},htmlXSell:function(a){var b=this.options.fields;
if(b.rating)for(var c=0;c<a.length;c++)a[c].normalizedVal=this.getNormalizedValue(this.value(a[c],b.rating));return html=this.compiledProd({prods:{items:a},fields:this.options.fields,opts:{overlayFields:!1}})},buildPromotionHTML:function(a){if(a&&a.length){for(var b="",c="",e=0;e<a.length;e++)b+='<li><a href="#xsell-'+e+'">'+a[e].type+"</a></li>",c+='<div id="xsell-'+e+'" class="ea-promotion-tab" style="padding: .5em 0em;">'+this.htmlXSell(a[e].items)+"</div>";d("#tabs").tabs("destroy");d("#tabs").html("<ul>"+
b+"</ul>"+c).tabs().show()}else d("#tabs").hide()},processPromotions:function(a,b){window.console&&console.log("id: "+a+" xsells: "+b.length);this.buildPromotionHTML(b)},showDetails:function(a,b,c){if(b){c=this.options.fields;var e=d("#ea-detailed-page");d(e).find("img.ea-detailed-image").removeClass("image-not-found").one("error",function(){d(this).addClass("image-not-found")}).attr("src",this.value(b,c.image)||"");d(e).find(".ea-detailed-desc").html(this.value(b,c.desc));d(e).find(".ea-detailed-price").html(this.value(b,
c.price)||"&nbsp;");d(e).find(".ea-detailed-id").text(this.value(b,c.id));d(e).dialog({dialogClass:"ea-detailed-dialog",title:this.value(b,c.name)+(this.value(b,c.mfr)?" by "+this.value(b,c.mfr):""),width:600,resizable:!1,modal:!0,buttons:[{text:"Add to order",click:function(){d(e).dialog("close")},showText:!1}]});this.getPromotionByType(a,0,this.promotionTypes,[])}},getOverlayColumnName:function(a,b){if("EAFeatured Weight"==b)return"EAWeight";if(a)for(var c=0;c<a.length;c++){if(a[c].columnName==b)return a[c].tagName}else return"EAShelfOrder"==
b?"":b},getOverlayColumnLabel:function(a){return"EAFeatured Weight"==a||"EAWeight"==a?"Business":"EAScore"==a?"Relevancy":"EAPersonalization"==a?"Personalization":a},insertNoResults:function(a){a&&a.message?d("#ea-no-results").html(a.message).show():d("#ea-no-results").hide()},insertProducts:function(a){if(a){var b="",b=null;if(this.options.overlayFields&&a&&a.itemDescription){var b=[],c=a.itemDescription.sortOrder;if(c)for(var e=c.split(","),c=0;c<e.length-1;c++){var f=e[c++],g=this.getOverlayColumnName(a.itemDescription.dataDescription,
f);g&&b.push({column:g,label:this.getOverlayColumnLabel(f)})}}e=this.options.fields;if(this.options.fields.rating)if(a.groups)for(c=0;c<a.groups.group.length;c++){f=a.groups.group[c];for(g=0;g<f.item.length;g++)f.item[g].normalizedVal=this.getNormalizedValue(this.value(f.item[g],e.rating))}else for(c=0;c<a.items.length;c++)a.items[c].normalizedVal=this.getNormalizedValue(this.value(a.items[c],e.rating));c={prods:a,fields:this.options.fields,opts:this.options};b&&b.length&&(c.oinfo=b);b=this.compiledProd(c);
d("#ea-products").html(b).show();if(a.groups){this.currentProducts=[];for(c=0;c<a.groups.group.length;c++){f=a.groups.group[c];for(g=0;g<f.item.length;g++)this.currentProducts.push(f.item[g])}d(".ea-results-controls").hide()}else this.updatePagination(a.itemDescription),this.currentProducts=a.items}else d("#ea-products").hide(),d(".ea-results-controls").hide(),this.currentProducts=[]},insertFeaturedProducts:function(a){if(a){for(var b=this.options.fields,c="",e=0;e<a.items.length;e++){var f=a.items[e],
g=b.url?this.value(f,b.url):null,h="";b.id&&f[b.id]&&(h=' ea-prod-id="'+this.htmlEncode(f[b.id])+'"');c+='<tr><td class="ea-featured-product-image-area"'+h+'><a href="'+(g||"#")+'"><img class="ea-featured-product-cell-image" src="'+f[b.image]+'"></a></td><td class="ea-featured-product-cell"><div class="ea-featured-product-name"><a href="'+(g||"#")+'"><div class="ea-product-cell-name">'+f[b.name]+'</div></a></div><div class="ea-featured-product-price">'+(f[b.price]||"&nbsp;")+'</div><div class="ea-featured-product-description">'+
f[b.desc]+"</div></td></tr>"}c&&(d("#ea-featured-products").html('<table class="ea-featured-product-title"><tr><td class="ea-featured-product-title">Featured Products</td></tr></table><table class="ea-featured-product-contents">'+c+"</table>").show(),this.featuredItems=a.items)}else d("#ea-featured-products").hide(),this.featuredItems=[]},insertCarveOuts:function(a){if(a&&a.length){for(var b=this.options.fields,c=[],e="",f=0;f<a.length;f++){var g=a[f];if(g.items){for(var e=e+('<div class="ea-carveout-area"><div class="ea-carveout-title">'+
g.attribute+'</div><div style="clear:both;"></div>'),h=g.displayFormat,e=e+"<table>",l=0;l<g.items.length;l++){var k=g.items[l],m=b.url?this.value(k,b.url):null,q="";b.id&&this.value(k,b.id)&&(q=' ea-prod-id="'+this.htmlEncode(this.value(k,b.id))+'"');e+='<tr><td class="ea-carveout-cell" align="center"'+q+">";"picture"==h&&(e+='<div class="ea-carveout-cell-image-area"><a href="'+(m||"#")+'"><img class="ea-carveout-cell-image" src="'+this.value(k,b.image)+'"/></a></div>');e+='<div class="ea-carveout-name-area"><a href="'+
(m||"#")+'"><div class="ea-carveout-cell-name">'+this.value(k,b.name)+"</div></a>";e+="</td></tr>";c.push(k)}e+="</table></div>"}}d("#ea-carveouts").html(e).show();this.currentCarveOuts=c}else d("#ea-carveouts").hide(),this.currentCarveOuts=[]},SWATCHES_PER_LINE:4,isLastNodeAttribute:function(a,b){var c=a[a.length-1].path.split("////");return 0==c[c.length-1].indexOf("AttribSelect="+b+" = '")},insertNavigation:function(a,b){var c="";if(this.options.ratingsAttribute&&a.attributes&&a.attributes.attribute)for(var e=
0;e<a.attributes.attribute.length;e++)if(c=a.attributes.attribute[e],c.name==this.options.ratingsAttribute){for(e=0;e<c.attributeValueList.length;e++)c.attributeValueList[e].normalizedVal=this.getNormalizedValue(c.attributeValueList[e].attributeValue);if(c.initialAttributeValueList)for(e=0;e<c.initialAttributeValueList.length;e++)c.initialAttributeValueList[e].normalizedVal=this.getNormalizedValue(c.initialAttributeValueList[e].attributeValue);break}if(a.attributes)for(e=0;e<a.attributes.attribute.length;e++){var c=
a.attributes.attribute[e],f=c.attributeValueList[0];if(f.valueType==this.ATTR_VALUE_TYPE_RANGE){var g=f.minRangeValue,h=f.maxRangeValue;this.isLastNodeAttribute(b,c.name)||(g=f.minValue,h=f.maxValue);f.effectiveMinRange=g;f.effectiveMaxRange=h}}c=this.compiledNav({cats:a.categories,attrs:a.attributes,stateInfo:a.stateInfo,commonAttrs:a.commonAttribute,opts:this.options});d("#ea-nav").html(c)},doCategoryClick:function(a){a=d(a).attr("ea-seo-path");this.executeBreadcrumbClick(a)},doAttributeClick:function(a){a=
d(a).attr("ea-seo-path");this.executeBreadcrumbClick(a)},getAllCheckedVals:function(a){var b=[];d(a).closest("ul.ea-nav-block-values").find("input:checked.ea-attr").each(function(a,e){b[d(e).attr("ea-val")]=!0});return b},doToplevelArrangeBy:function(a){a=d(a).attr("ea-group");this.executeToplevelArrangeBy(a)},doBreadcrumbClick:function(a){a=d(a).attr("ea-seo-path");this.executeBreadcrumbClick(a)},doBreadcrumbRemove:function(a){a=d(a).attr("ea-seo-path");this.executeBreadcrumbClick(a)},bannerClick:function(a){var b=
d(a).attr("ea-seo-path");if(b)this.executeBreadcrumbClick(b);else{var b=d(a).attr("ea-path"),c=d(a).attr("ea-attr");c?this.executeAttribute(c,d(a).attr("ea-val"),b):(a=d(a).attr("ea-srch"))?this.executeSearch(a,b):this.executeBreadcrumbClick(b)}},buildRangeSEOValue:function(a,b,c,d){return(0>a?"\\":"")+a+"-"+(0>b?"\\":"")+b+"-"+(0>c?"\\":"")+c+"-"+(0>d?"\\":"")+d},buildRangeValue:function(a,b,c,d,f){return f?(0>a?"\\":"")+a+"-"+(0>b?"\\":"")+b+"-"+(0>c?"\\":"")+c+"-"+(0>d?"\\":"")+d:(0>a?"\\":"")+
a+"@"+(0>b?"\\":"")+b+"@"+(0>c?"\\":"")+c+"@"+(0>d?"\\":"")+d},processRange:function(a,b,c,d,f,g,h){b=this.rawNumber(b.value.replace(/[^0-9\.\-]+/g,""),2);c=this.rawNumber(c.value.replace(/[^0-9\.\-]+/g,""),2);b<=c-g&&(d=this.buildRangeValue(b,c,d,f,h),this.executeRangeAttr(a,d,h))},hookProductDetails:function(){var a=this;d(".ea-product-cell").each(function(){var b=d(this).attr("ea-prod-id");b&&d(this).find('a[href="#"]').click(function(c){a.showDetails(b,a.findItem(b),a.seoPath);c.preventDefault();
return!1})})},hookFeaturedItems:function(){var a=this;d(".ea-featured-product-cell").each(function(){var b=d(this).attr("ea-prod-id");b&&d(this).find('a[href="#"]').click(function(c){a.showDetails(b,a.findFeaturedItem(b));c.preventDefault();return!1})})},hookCarveOutDetails:function(){var a=this;d(".ea-carveout-cell").each(function(){var b=d(this).attr("ea-prod-id");b&&d(this).find('a[href="#"]').click(function(c){a.showDetails(b,a.findCarveOut(b));c.preventDefault();return!1})})},hookNoResults:function(){var a=
this;d("li.ea-no-results-link a").click(function(b){a.doBreadcrumbClick(this);b.preventDefault();return!1})},hookNav:function(){var a=this;d("a.ea-cat").click(function(b){a.doCategoryClick(this);b.preventDefault();return!1});d("input.ea-attr").click(function(){var a=d(this).next();a.length&&d(a).click()});d(".ea-color-swatch,.ea-size-swatch").click(function(b){a.doAttributeClick(this);b.preventDefault();return!1});d("a.ea-attr").click(function(b){a.doAttributeClick(this);b.preventDefault();return!1});
d(".ea-current-state a.ea-selected").click(function(b){a.doBreadcrumbRemove(this);b.preventDefault();return!1});d(".ea-current-state a.ea-left-hotspot").click(function(b){a.doBreadcrumbRemove(d(this).next());b.preventDefault();return!1});d("a.ea-bc").click(function(b){a.doBreadcrumbClick(this);b.preventDefault();return!1});d("a .ea-nav-title").click(function(){d(this).toggleClass("ea-collapse").parents(".ea-nav-block").find(".ea-nav-block-values").toggle();return!1});d("ul.ea-nav-block-values").each(function(){var a=
d(this).children("div");2==a.length&&a.each(function(){d(this).find(".ea-nav-val-toggle a").each(function(c,e){d(e).click(function(){d(a).toggle();return!1})})})});d("a.ea-banner-anchor[ea-action]").each(function(b,c){d(c).click(function(b){a.bannerClick(this);b.preventDefault();return!1})});d(".ea-banner-wrapper img").one("error",function(){d(this).addClass("image-not-found")});d(".ea-range-attr").each(function(){var b=d(this).attr("eaMin"),c=d(this).attr("eaMax"),e=d(this).attr("ea-attr"),f=d(this).attr("eaMinRange"),
g=d(this).attr("eaMaxRange"),h=Number(d(this).attr("eaScale")||1),l=d(this).siblings(".ea-range-min")[0],k=d(this).siblings(".ea-range-max")[0],m=d(this).attr("ea_node");d(this).slider({range:!0,min:Number(f),max:Number(g),step:h,values:[Number(b),Number(c)],change:function(b,c){var d=a.buildRangeValue(a.rawNumber(c.values[0],2),a.rawNumber(c.values[1],2),f,g,m);a.executeRangeAttr(e,d,m);b.preventDefault();return!1},create:function(){l.value=a.formatNumber(b,2);k.value=a.formatNumber(c,2)},slide:function(b,
c){var d=c.values[0],e=c.values[1];if(d<=e-h)l.value=a.formatNumber(d,2),k.value=a.formatNumber(e,2);else return!1}});d(l).keypress(function(b){if(13==b.which)return a.processRange(e,l,k,f,g,h,m),b.preventDefault(),!1}).change(function(b){a.processRange(e,l,k,f,g,h,m);b.preventDefault();return!1});d(k).keypress(function(b){if(13==b.which)return a.processRange(e,l,k,f,g,h,m),b.preventDefault(),!1}).change(function(b){a.processRange(e,l,k,f,g,h,m);b.preventDefault();return!1})});d(".ea-color-swatch,.ea-size-swatch").hover(function(){d(this).addClass("ea-active")},
function(){d(this).removeClass("ea-active")})},processMessage:function(a){a?d("#ea-msg").html(a).show():d("#ea-msg").hide()},processBC:function(a){html="";for(var b=0;b<a.length;b++){0<b&&(html+="&nbsp;/&nbsp;");var c="";if(2==a[b].navNodePathType){var e=a[b].path.split("////"),e=e[e.length-1];0==e.indexOf("AttribSelect=")&&(c=e.substring(13,e.indexOf(" = ")))&&(c='<span class="ea-attr-name">'+this.htmlEncode(c)+"</span>:&nbsp;")}html+='<a class="ea-bc" ea-seo-path="'+this.htmlEncode(a[b].seoPath||
"")+'" ea_bc="'+this.htmlEncode(a[b].path)+'" href="#">'+c+this.htmlEncode(a[b].value)+"</a>"}d("#ea-bc").html(html)},insertBanners:function(a){d(".ea-banner-zone").empty().hide();if(a)for(var b=0;b<a.length;b++)a[b].zone&&d("#"+a[b].zone).append(a[b].html).show()},isNonZeroResults:function(a){return a&&a.products&&a.products.itemDescription&&0<a.products.itemDescription.totalItems},isQueryModified:function(a){return a&&a.itemsFoundByModifyingQuery},recordUserSearch:function(a){a=(a||{}).source;this.isNonZeroResults(a)&&
!this.isQueryModified(a)&&n&&n.add(a.originalQuestion)},ERROR_REDIRECT:5,PRESENTATION_ERROR:-1,processResults:function(a,b){n&&b&&this.recordUserSearch(a);a.displayFormat&&(a.displayFormat.presentation==this.PRESENTATION_ERROR&&a.displayFormat.error==this.ERROR_REDIRECT)&&window.location.replace(a.errorMsg);d("#question").val("").attr("placeholder")||d("#question:not(:focus)").blur();if(a){var c=a.source;if(c){var e=c.navPath.navPathNodeList;this.processMessage(c.message);this.processBC(e);this.path=
e[e.length-1].path;this.seoPath=e[e.length-1].seoPath||"";this.insertProducts(c.products);this.hookProductDetails();this.insertNoResults(c.noResults);this.hookNoResults();this.insertBanners(c.displayBanners);this.insertFeaturedProducts(c.products&&!c.products.groups?c.featuredProducts:null);this.hookFeaturedItems();this.insertCarveOuts(c.carveOuts);this.hookCarveOutDetails();this.insertNavigation(c,e);this.hookNav();d("img.ea-product-cell-image, img.ea-featured-product-cell-image, img.ea-carveout-cell-image").one("error",
function(){d(this).addClass("image-not-found")});var f=0;this.options.facetsExpanded?f=this.options.facetsExpanded:c.attributes&&c.attributes.isInitDispLimited&&(f=c.attributes.initDispLimit,c.categories&&f++);1<e.length&&f++;f&&d("a .ea-nav-title").each(function(a,b){a>=f&&d(b).click()})}}},htmlEncode:function(a){return String(a||"").replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},encodeSearch:function(a){var b="";if(a&&0<a.length)for(var b=
"-",c=0;c<a.length;c++)var d=a[c],b=/\s/.test(d)?b+"-":"/"==d?b+"@":"@"==d?b+"\\@":"-"==d?b+"\\-":b+d;return b},invoke:function(a){var b=d.urlParam("CatPath",a);b||(b=d.urlParam("ea_path",a));b&&(b=decodeURIComponent(b));var c=d.urlParam("q",a);c&&(b&&(b+="/"),b+=this.encodeSearch(decodeURIComponent(c)));(c=d.urlParam("AttribSel",a))&&(b+="&AttribSel="+decodeURIComponent(c));href=window.location.origin+window.location.pathname;history.pushState(a,null,href+"?dct="+this.config.dct+(b?"&ea_path="+b:
""));window.console&&console.log("invoke: "+a);this.executeCall(a)},isSearchRequest:function(a){return a&&-1<a.indexOf("RequestAction=advisor")&&-1<a.indexOf("&RequestData=CA_Search")},executeCall:function(a){window.console&&console.log("executeCall: "+a);var b=this,c=b.isSearchRequest(a);d.ajax({url:a,type:"POST",crossDomain:!0,dataType:"jsonp",success:function(a,d,g){b.processResults(a,c)},error:function(a,b,c){alert("error: "+a)}})}};return EASearchDemo});
